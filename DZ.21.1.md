*А можно было бы и git push --force...*

# Сценарий оформления заказа для авторизованного пользователя

**Цель**: оформить новый заказ.  
**Акторы**: пользователь, система (сайт, бэкенд).  
**Контекст**: пользователь сформировал заказ и хочет его оформить.  
**Предусловие**: пользователь набрал корзину и нажал на кнопку “Оформить заказ”. Если пользователь не был авторизован, система проводит его через процедуру авторизации ([Сценарий процедуры авторизации пользователя](https://mk-sa.atlassian.net/wiki/spaces/N/pages/19759288)).

**Основной сценарий**:

1. Система предлагает пользователю указать адрес доставки: либо ввести новый, либо выбрать из адресов, ранее указанных в личном кабинете или предыдущих заказах.
2. Пользователь указывает адрес доставки.
3. Система предлагает выбрать время доставки, сообразуясь со временем приготовления заказа, загруженностью кухни и службы доставки, а также дальностью адреса доставки.
4. Пользователь выбирает время доставки.
5. Система предлагает выбрать способ оплаты заказа: онлайн или наличные курьеру (*radio*).
6. Пользователь выбирает способ оплаты. 
7. Система отображает кнопку “Отправить заказ”. 
8. Пользователь нажимает кнопку “Отправить заказ”. *Примечание*: до нажатия этой кнопки возможна обратная навигация на страницу формирования заказа для его редактирования; после нажатия на эту кнопку изменить данные заказа невозможно.
9. Система обновляет список адресов доставки (*если в заказе указан ранее не вводившийся адрес, он добавляется к списку*).
10. Система добавляет новый заказ в историю заказов со статусом “новый заказ”.
11. Система перенаправляет пользователя на сайт процессингового сервиса ([Сценарий онлайн-оплаты заказа](https://mk-sa.atlassian.net/wiki/spaces/N/pages/19759328)), если была выбрана онлайн-оплата. В противном случае система переводит заказ в статус “оформлен” и отправляет его диспетчеру.
